# Jay Crew — Project Briefing
> Project: **my-ecommerce** · Generated: 2026-02-27T16:49:56.506Z

---

## How to Use

Paste this file into Claude Code (or any AI assistant) and say:

> **"You are the Jay Crew Orchestrator. Run the full crew analysis for the task described below."**

The AI will act as the Orchestrator, run each specialist's X-Ray, and produce a complete execution plan.

---

## User Request

> Audit the authentication flow and create an implementation plan for adding role-based access control (RBAC)

---

## Suggested Crew

Based on the request, the following specialists were selected:

- `software-architect`
- `backend-dev`
- `security`
- `business-analyst`
- `engine`

---

## Project Context

## Project Structure: my-ecommerce

### File Tree
```
my-ecommerce/
├── backend/
│   ├── data/
│   │   ├── shopco.mv.db  (92.0 KB)
│   │   └── shopco.trace.db  (3.3 KB)
│   ├── src/
│   │   ├── main/
│   │   │   ├── docker/
│   │   │   │   ├── Dockerfile.jvm  (5.5 KB)
│   │   │   │   ├── Dockerfile.legacy-jar  (5.3 KB)
│   │   │   │   ├── Dockerfile.native  (843 B)
│   │   │   │   └── Dockerfile.native-micro  (1.0 KB)
│   │   │   ├── java/
│   │   │   │   └── com/
│   │   │   │       └── shopco/
│   │   │   │           └── ecommerce/
│   │   │   │               ├── dto/
│   │   │   │               │   ├── AddressDTO.java  (793 B)
│   │   │   │               │   ├── CartDTO.java  (1.2 KB)
│   │   │   │               │   ├── CartItemDTO.java  (591 B)
│   │   │   │               │   ├── CouponValidationDTO.java  (293 B)
│   │   │   │               │   ├── OrderDTO.java  (1.1 KB)
│   │   │   │               │   ├── OrderItemDTO.java  (582 B)
│   │   │   │               │   └── ProductDTO.java  (928 B)
│   │   │   │               ├── entity/
│   │   │   │               │   ├── Address.java  (1014 B)
│   │   │   │               │   ├── Cart.java  (623 B)
│   │   │   │               │   ├── CartItem.java  (796 B)
│   │   │   │               │   ├── Coupon.java  (1.6 KB)
│   │   │   │               │   ├── NewsletterSubscriber.java  (685 B)
│   │   │   │               │   ├── Order.java  (1.4 KB)
│   │   │   │               │   ├── OrderItem.java  (738 B)
│   │   │   │               │   └── Product.java  (1.4 KB)
│   │   │   │               ├── filter/
│   │   │   │               │   └── SecurityHeadersFilter.java  (993 B)
│   │   │   │               ├── resource/
│   │   │   │               │   ├── AddressResource.java  (2.3 KB)
│   │   │   │               │   ├── CartResource.java  (6.2 KB)
│   │   │   │               │   ├── CouponResource.java  (1.8 KB)
│   │   │   │               │   ├── NewsletterResource.java  (2.3 KB)
│   │   │   │               │   ├── OrderResource.java  (4.2 KB)
│   │   │   │               │   └── ProductResource.java  (1.9 KB)
│   │   │   │               └── service/
│   │   │   │                   └── GeocodingService.java  (2.6 KB)
│   │   │   └── resources/
│   │   │       ├── db/
│   │   │       │   └── migration/
│   │   │       │       ├── V1__create_tables.sql  (3.1 KB)
│   │   │       │       ├── V2__seed_products.sql  (2.5 KB)
│   │   │       │       ├── V3__seed_coupons.sql  (380 B)
│   │   │       │       ├── V4__add_sequences.sql  (429 B)
│   │   │       │       └── V5__fix_sequence_increment.sql  (1.4 KB)
│   │   │       ├── META-INF/
│   │   │       │   └── resources/
│   │   │       │       └── index.html  (240.4 KB)
│   │   │       ├── application.properties  (966 B)
│   │   │       └── import.sql  (370 B)
│   │   └── test/
│   │       ├── java/
│   │       │   └── com/
│   │       │       └── shopco/
│   │       │           └── ecommerce/
│   │       │               ├── CartResourceTest.java  (2.6 KB)
│   │       │               ├── CouponResourceTest.java  (1.1 KB)
│   │       │               ├── NewsletterResourceTest.java  (1.0 KB)
│   │       │               └── ProductResourceTest.java  (973 B)
│   │       └── resources/
│   │           └── application.properties  (117 B)
│   ├── mvnw  (11.5 KB)
│   ├── mvnw.cmd  (8.1 KB)
│   ├── pom.xml  (5.1 KB)
│   └── README.md  (935 B)
├── docs/
│   └── ARCHITECTURE_IMPROVEMENTS.md  (7.9 KB)
├── e2e/
│   ├── cart.spec.ts  (365 B)
│   ├── home.spec.ts  (500 B)
│   └── shop.spec.ts  (796 B)
├── playwright-report/
│   └── index.html  (520.4 KB)
├── public/
│   ├── file.svg  (391 B)
│   ├── globe.svg  (1.0 KB)
│   ├── next.svg  (1.3 KB)
│   ├── vercel.svg  (128 B)
│   └── window.svg  (385 B)
├── src/
│   ├── app/
│   │   ├── cart/
│   │   │   └── page.tsx  (4.8 KB)
│   │   ├── checkout/
│   │   │   └── page.tsx  (12.3 KB)
│   │   ├── order/
│   │   │   └── [orderCode]/
│   │   │       └── page.tsx  (3.7 KB)
│   │   ├── shop/
│   │   │   ├── [id]/
│   │   │   │   └── page.tsx  (4.0 KB)
│   │   │   └── page.tsx  (2.3 KB)
│   │   ├── favicon.ico  (25.3 KB)
│   │   ├── globals.css  (255 B)
│   │   ├── layout.tsx  (1.3 KB)
│   │   ├── page.tsx  (352 B)
│   │   └── providers.tsx  (581 B)
│   ├── components/
│   │   ├── AddressMap.tsx  (1.4 KB)
│   │   ├── ApiStatusBanner.tsx  (809 B)
│   │   ├── BrandLogos.tsx  (792 B)
│   │   ├── CartDrawer.tsx  (5.6 KB)
│   │   ├── CouponInput.tsx  (1.7 KB)
│   │   ├── ErrorBoundary.tsx  (1.0 KB)
│   │   ├── FeaturedProducts.tsx  (2.5 KB)
│   │   ├── Footer.tsx  (3.3 KB)
│   │   ├── Header.tsx  (4.5 KB)
│   │   ├── Hero.tsx  (3.2 KB)
│   │   ├── NewsletterSignup.tsx  (2.3 KB)
│   │   ├── ProductCard.tsx  (2.3 KB)
│   │   ├── ProductGrid.tsx  (1.7 KB)
│   │   └── Stats.tsx  (868 B)
│   ├── lib/
│   │   ├── api.test.ts  (1.1 KB)
│   │   └── api.ts  (4.8 KB)
│   ├── store/
│   │   ├── cart-store.test.ts  (1.7 KB)
│   │   └── cart-store.ts  (2.7 KB)
│   └── test/
│       └── setup.ts  (432 B)
├── test-results/
├── .env.example  (67 B)
├── eslint.config.mjs  (465 B)
├── next-env.d.ts  (247 B)
├── next.config.ts  (451 B)
├── package-lock.json  (313.5 KB)
├── package.json  (1.4 KB)
├── playwright.config.ts  (724 B)
├── postcss.config.mjs  (94 B)
├── README.md  (2.1 KB)
├── tsconfig.json  (670 B)
└── vitest.config.ts  (395 B)

```

### Statistics
- Total files: 96
- Total size: 1.3 MB
- Entry points: none detected

### File Types
  .java: 27
  .tsx: 22
  .ts: 12
  .sql: 6
  .svg: 5
  .md: 3
  .json: 3
  .db: 2
  .html: 2
  .properties: 2

## Configuration Files
### backend/pom.xml
```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.shopco</groupId>
  <artifactId>backend</artifactId>
  <version>1.0.0-SNAPSHOT</version>
  <properties>
    <compiler-plugin.version>3.14.1</compiler-plugin.version>
    <maven.compiler.release>17</maven.compiler.release>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
    <quarkus.platform.artifact-id>quarkus-bom</quarkus.platform.artifact-id>
    <quarkus.platform.group-id>io.quarkus.platform</quarkus.platform.group-id>
    <quarkus.platform.version>3.31.4</quarkus.platform.version>
    <skipITs>true</skipITs>
    <surefire-plugin.version>3.5.4</surefire-plugin.version>
  </properties>
  <dependencyManagement>
    <dependencies>
      <dependency>
        <groupId>${quarkus.platform.group-id}</groupId>
        <artifactId>${quarkus.platform.artifact-id}</artifactId>
        <version>${quarkus.platform.version}</version>
        <type>pom</type>
        <scope>import</scope>
      </dependency>
    </dependencies>
  </dependencyManagement>
  <dependencies>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-hibernate-orm-panache</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-rest-jackson</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-flyway</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-smallrye-openapi</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-jdbc-h2</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-arc</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-hibernate-orm</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-rest</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-rest-client</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-rest-client-jackson</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-junit5</artifactId>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>io.rest-assured</groupId>
      <artifactId>rest-assured</artifactId>
      <scope>test</scope>
    </dependency>
  </dependencies>
  <build>
    <plugins>
      <plugin>
        <groupId>${quarkus.platform.group-id}</groupId>
        <artifactId>quarkus-maven-plugin</artifactId>
        <version>${quarkus.platform.version}</version>
        <extensions>true</extensions>
        <executions>
          <execution>
            <goals>
              <goal>build</goal>
              <goal>generate-code</goal>
              <goal>generate-code-tests</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>${compiler-plugin.version}</version>
        <configuration>
          <compilerArgs>
            <arg>-parameters</arg>
          </compilerArgs>
        </configuration>
      </plugin>
      <plugin>
        <artifactId>maven-surefire-plugin</artifactId>
        <version>${surefire-plugin.version}</version>
        <configuration>
          <systemPropertyVariables>
            <java.util.logging.manager>org.jboss.logmanager.LogManager</java.util.logging.manager>
            <maven.home>${maven.home}</maven.home>
          </systemPropertyVariables>
        </configuration>
      </plugin>
      <plugin>
        <artifactId>maven-failsafe-plugin</artifactId>
        <version>${surefire-plugin.version}</version>
        <executions>
          <execution>
            <goals>
              <goal>integration-test</goal>
              <goal>verify</goal>
            </goals>
          </execution>
        </executions>
        <configuration>
          <systemPropertyVariables>
            <native.image.path>${project.build.directory}/${project.build.finalName}-runner</native.image.path>
            <java.util.logging.manager>org.jboss.logmanager.LogManager</java.util.logging.manager>
            <maven.home>${maven.home}</maven.home>
          </systemPropertyVariables>
        </configuration>
      </plugin>
    </plugins>
  </build>
  <profiles>
    <profile>
      <id>native</id>
      <activation>
        <property>
          <name>native</name>
        </property>
      </activation>
      <properties>
        <skipITs>false</skipITs>
        <quarkus.package.type>native</quarkus.package.type>
      </properties>
    </profile>
  </profiles>
</project>

```

### .env.example
```
# API base URL (backend)
NEXT_PUBLIC_API_URL=http://localhost:8080

```

### eslint.config.mjs
```
import { defineConfig, globalIgnores } from "eslint/config";
import nextVitals from "eslint-config-next/core-web-vitals";
import nextTs from "eslint-config-next/typescript";

const eslintConfig = defineConfig([
  ...nextVitals,
  ...nextTs,
  // Override default ignores of eslint-config-next.
  globalIgnores([
    // Default ignores of eslint-config-next:
    ".next/**",
    "out/**",
    "build/**",
    "next-env.d.ts",
  ]),
]);

export default eslintConfig;

```

### next.config.ts
```
import type { NextConfig } from "next";
import path from "path";

const nextConfig: NextConfig = {
  turbopack: {
    root: path.resolve(__dirname),
  },
  images: {
    remotePatterns: [
      {
        protocol: "https",
        hostname: "images.unsplash.com",
        pathname: "/**",
      },
      {
        protocol: "https",
        hostname: "via.placeholder.com",
        pathname: "/**",
      },
    ],
  },
};

export default nextConfig;

```

### package.json
```
{
  "name": "my-ecommerce",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint",
    "dev:backend": "cd backend && ./mvnw quarkus:dev",
    "dev:all": "concurrently -n \"backend,frontend\" -c \"blue,green\" \"npm run dev:backend\" \"npm run dev\"",
    "test": "vitest run",
    "test:watch": "vitest",
    "test:e2e": "playwright test",
    "test:e2e:ui": "playwright test --ui",
    "test:all": "npm run test && cd backend && ./mvnw test -q && cd .. && npm run build && npm run test:e2e"
  },
  "dependencies": {
    "@hookform/resolvers": "^5.2.2",
    "@tanstack/react-query": "^5.90.21",
    "leaflet": "^1.9.4",
    "next": "16.1.6",
    "react": "19.2.3",
    "react-dom": "19.2.3",
    "react-hook-form": "^7.71.1",
    "react-leaflet": "^5.0.0",
    "zod": "^4.3.6",
    "zustand": "^5.0.11"
  },
  "devDependencies": {
    "@playwright/test": "^1.49.0",
    "@tailwindcss/postcss": "^4",
    "@testing-library/jest-dom": "^6.6.3",
    "@testing-library/react": "^16.3.0",
    "@types/leaflet": "^1.9.21",
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "@vitejs/plugin-react": "^5.1.4",
    "concurrently": "^9.1.2",
    "eslint": "^9",
    "eslint-config-next": "16.1.6",
    "jsdom": "^26.0.0",
    "tailwindcss": "^4",
    "typescript": "^5",
    "vitest": "^3.2.4"
  }
}

```

### tsconfig.json
```
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "react-jsx",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts",
    ".next/dev/types/**/*.ts",
    "**/*.mts"
  ],
  "exclude": ["node_modules"]
}

```

### vitest.config.ts
```
import { defineConfig } from "vitest/config";
import react from "@vitejs/plugin-react";
import path from "path";

export default defineConfig({
  plugins: [react()],
  test: {
    environment: "jsdom",
    globals: true,
    setupFiles: ["./src/test/setup.ts"],
    include: ["src/**/*.test.{ts,tsx}"],
  },
  resolve: {
    alias: {
      "@": path.resolve(__dirname, "./src"),
    },
  },
});

```

## Dependencies
### backend/pom.xml
```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.shopco</groupId>
  <artifactId>backend</artifactId>
  <version>1.0.0-SNAPSHOT</version>
  <properties>
    <compiler-plugin.version>3.14.1</compiler-plugin.version>
    <maven.compiler.release>17</maven.compiler.release>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
    <quarkus.platform.artifact-id>quarkus-bom</quarkus.platform.artifact-id>
    <quarkus.platform.group-id>io.quarkus.platform</quarkus.platform.group-id>
    <quarkus.platform.version>3.31.4</quarkus.platform.version>
    <skipITs>true</skipITs>
    <surefire-plugin.version>3.5.4</surefire-plugin.version>
  </properties>
  <dependencyManagement>
    <dependencies>
      <dependency>
        <groupId>${quarkus.platform.group-id}</groupId>
        <artifactId>${quarkus.platform.artifact-id}</artifactId>
        <version>${quarkus.platform.version}</version>
        <type>pom</type>
        <scope>import</scope>
      </dependency>
    </dependencies>
  </dependencyManagement>
  <dependencies>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-hibernate-orm-panache</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-rest-jackson</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-flyway</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-smallrye-openapi</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-jdbc-h2</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-arc</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-hibernate-orm</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-rest</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-rest-client</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-rest-client-jackson</artifactId>
    </dependency>
    <dependency>
      <groupId>io.quarkus</groupId>
      <artifactId>quarkus-junit5</artifactId>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>io.rest-assured</groupId>
      <artifactId>rest-assured</artifactId>
      <scope>test</scope>
    </dependency>
  </dependencies>
  <build>
    <plugins>
      <plugin>
        <groupId>${quarkus.platform.group-id}</groupId>
        <artifactId>quarkus-maven-plugin</artifactId>
        <version>${quarkus.platform.version}</version>
        <extensions>true</extensions>
        <executions>
          <execution>
            <goals>
              <goal>build</goal>
              <goal>generate-code</goal>
              <goal>generate-code-tests</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>${compiler-plugin.version}</version>
        <configuration>
          <compilerArgs>
            <arg>-parameters</arg>
          </compilerArgs>
        </configuration>
      </plugin>
      <plugin>
        <artifactId>maven-surefire-plugin</artifactId>
        <version>${surefire-plugin.version}</version>
        <configuration>
          <systemPropertyVariables>
            <java.util.logging.manager>org.jboss.logmanager.LogManager</java.util.logging.manager>
            <maven.home>${maven.home}</maven.home>
          </systemPropertyVariables>
        </configuration>
      </plugin>
      <plugin>
        <artifactId>maven-failsafe-plugin</artifactId>
        <version>${surefire-plugin.version}</version>
        <executions>
          <execution>
            <goals>
              <goal>integration-test</goal>
              <goal>verify</goal>
            </goals>
          </execution>
        </executions>
        <configuration>
          <systemPropertyVariables>
            <native.image.path>${project.build.directory}/${project.build.finalName}-runner</native.image.path>
            <java.util.logging.manager>org.jboss.logmanager.LogManager</java.util.logging.manager>
            <maven.home>${maven.home}</maven.home>
          </systemPropertyVariables>
        </configuration>
      </plugin>
    </plugins>
  </build>
  <profiles>
    <profile>
      <id>native</id>
      <activation>
        <property>
          <name>native</name>
        </property>
      </activation>
      <properties>
        <skipITs>false</skipITs>
        <quarkus.package.type>native</quarkus.package.type>
      </properties>
    </profile>
  </profiles>
</project>

```

### package-lock.json
```
{
  "name": "my-ecommerce",
  "version": "0.1.0",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {
    "": {
      "name": "my-ecommerce",
      "version": "0.1.0",
      "dependencies": {
        "@hookform/resolvers": "^5.2.2",
        "@tanstack/react-query": "^5.90.21",
        "leaflet": "^1.9.4",
        "next": "16.1.6",
        "react": "19.2.3",
        "react-dom": "19.2.3",
        "react-hook-form": "^7.71.1",
        "react-leaflet": "^5.0.0",
        "zod": "^4.3.6",
        "zustand": "^5.0.11"
      },
      "devDependencies": {
        "@playwright/test": "^1.49.0",
        "@tailwindcss/postcss": "^4",
        "@testing-library/jest-dom": "^6.6.3",
        "@testing-library/react": "^16.3.0",
        "@types/leaflet": "^1.9.21",
        "@types/node": "^20",
        "@types/react": "^19",
        "@types/react-dom": "^19",
        "@vitejs/plugin-react": "^5.1.4",
        "concurrently": "^9.1.2",
        "eslint": "^9",
        "eslint-config-next": "16.1.6",
        "jsdom": "^26.0.0",
        "tailwindcss": "^4",
        "typescript": "^5",
        "vitest": "^3.2.4"
      }
    },
    "node_modules/@adobe/css-tools": {
      "version": "4.4.4",
      "resolved": "https://registry.npmjs.org/@adobe/css-tools/-/css-tools-4.4.4.tgz",
      "integrity": "sha512-Elp+iwUx5rN5+Y8xLt5/GRoG20WGoDCQ/1Fb+1LiGtvwbDavuSk0jhD/eZdckHAuzcDzccnkv+rEjyWfRx18gg==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@alloc/quick-lru": {
      "version": "5.2.0",
      "resolved": "https://registry.npmjs.org/@alloc/quick-lru/-/quick-lru-5.2.0.tgz",
      "integrity": "sha512-UrcABB+4bUrFABwbluTIBErXwvbsU/V7TZWfmbgJfbkwiBuziS9gxdODUyuiecfdGQ85jglMW6juS3+z5TsKLw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/@asamuzakjp/css-color": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/@asamuzakjp/css-color/-/css-color-3.2.0.tgz",
      "integrity": "sha512-K1A6z8tS3XsmCMM86xoWdn7Fkdn9m6RSVtocUrJYIwZnFVkng/PvkEoWtOWmP+Scc6saYWHWZYbndEEXxl24jw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@csstools/css-calc": "^2.1.3",
        "@csstools/css-color-parser": "^3.0.9",
        "@csstools/css-parser-algorithms": "^3.0.4",
        "@csstools/css-tokenizer": "^3.0.3",
        "lru-cache": "^10.4.3"
      }
    },
    "node_modules/@asamuzakjp/css-color/node_modules/lru-cache": {
      "version": "10.4.3",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-10.4.3.tgz",
      "integrity": "sha512-JNAzZcXrCt42VGLuYz0zfAzDfAvJWW6AfYlDBQyDV5DClI2m5sAmK+OIO7s59XfsRsWHp02jAJrRadPRGTt6SQ==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/@babel/code-frame": {
      "version": "7.29.0",
      "resolved": "https://registry.npmjs.org/@babel/code-frame/-/code-frame-7.29.0.tgz",
      "integrity": "sha512-9NhCeYjq9+3uxgdtp20LSiJXJvN0FeCtNGpJxuMFZ1Kv3cWUNb6DOhJwUvcVCzKGR66cw4njwM6hrJLqgOwbcw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-validator-identifier": "^7.28.5",
        "js-tokens": "^4.0.0",
        "picocolors": "^1.1.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/compat-data": {
      "version": "7.29.0",
      "resolved": "https://registry.npmjs.org/@babel/compat-data/-/compat-data-7.29.0.tgz",
      "integrity": "sha512-T1NCJqT/j9+cn8fvkt7jtwbLBfLC/1y1c7NtCeXFRgzGTsafi68MRv8yzkYSapBnFA6L3U2VSc02ciDzoAJhJg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/core": {
      "version": "7.29.0",
      "resolved": "https://registry.npmjs.org/@babel/core/-/core-7.29.0.tgz",
      "integrity": "sha512-CGOfOJqWjg2qW/Mb6zNsDm+u5vFQ8DxXfbM09z69p5Z6+mE1ikP2jUXw+j42Pf1XTYED2Rni5f95npYeuwMDQA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/code-frame": "^7.29.0",
        "@babel/generator": "^7.29.0",
        "@babel/helper-compilation-targets": "^7.28.6",
        "@babel/helper-module-transforms": "^7.28.6",
        "@babel/helpers": "^7.28.6",
        "@babel/parser": "^7.29.0",
        "@babel/template": "^7.28.6",
        "@babel/traverse": "^7.29.0",
        "@babel/types": "^7.29.0",
        "@jridgewell/remapping": "^2.3.5",
        "convert-source-map": "^2.0.0",
        "debug": "^4.1.0",
        "gensync": "^1.0.0-beta.2",
        "json5": "^2.2.3",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/babel"
      }
    },
    "node_modules/@babel/generator": {
      "version": "7.29.1",
      "resolved": "https://registry.npmjs.org/@babel/generator/-/generator-7.29.1.tgz",
      "integrity": "sha512-qsaF+9Qcm2Qv8SRIMMscAvG4O3lJ0F1GuMo5HR/Bp02LopNgnZBC/EkbevHFeGs4ls/oPz9v+Bsmzbkbe+0dUw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/parser": "^7.29.0",
        "@babel/types": "^7.29.0",
        "@jridgewell/gen-mapping": "^0.3.12",
        "@jridgewell/trace-mapping": "^0.3.28",
        "jsesc": "^3.0.2"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-compilation-targets": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/helper-compilation-targets/-/helper-compilation-targets-7.28.6.tgz",
      "integrity": "sha512-JYtls3hqi15fcx5GaSNL7SCTJ2MNmjrkHXg4FSpOA/grxK8KwyZ5bubHsCq8FXCkua6xhuaaBit+3b7+VZRfcA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/compat-data": "^7.28.6",
        "@babel/helper-validator-option": "^7.27.1",
        "browserslist": "^4.24.0",
        "lru-cache": "^5.1.1",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-globals": {
      "version": "7.28.0",
      "resolved": "https://registry.npmjs.org/@babel/helper-globals/-/helper-globals-7.28.0.tgz",
      "integrity": "sha512-+W6cISkXFa1jXsDEdYA8HeevQT/FULhxzR99pxphltZcVaugps53THCeiWA8SguxxpSp3gKPiuYfSWopkLQ4hw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-imports": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-imports/-/helper-module-imports-7.28.6.tgz",
      "integrity": "sha512-l5XkZK7r7wa9LucGw9LwZyyCUscb4x37JWTPz7swwFE/0FMQAGpiWUZn8u9DzkSBWEcK25jmvubfpw2dnAMdbw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/traverse": "^7.28.6",
        "@babel/types": "^7.28.6"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-transforms": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-transforms/-/helper-module-transforms-7.28.6.tgz",
      "integrity": "sha512-67oXFAYr2cDLDVGLXTEABjdBJZ6drElUSI7WKp70NrpyISso3plG9SAGEF6y7zbha/wOzUByWWTJvEDVNIUGcA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-module-imports": "^7.28.6",
        "@babel/helper-validator-identifier": "^7.28.5",
        "@babel/traverse": "^7.28.6"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0"
      }
    },
    "node_modules/@babel/helper-plugin-utils": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/helper-plugin-utils/-/helper-plugin-utils-7.28.6.tgz",
      "integrity": "sha512-S9gzZ/bz83GRysI7gAD4wPT/AI3uCnY+9xn+Mx/KPs2JwHJIz1W8PZkg2cqyt3RNOBM8ejcXhV6y8Og7ly/Dug==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-string-parser": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-string-parser/-/
```

### package.json
```
{
  "name": "my-ecommerce",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint",
    "dev:backend": "cd backend && ./mvnw quarkus:dev",
    "dev:all": "concurrently -n \"backend,frontend\" -c \"blue,green\" \"npm run dev:backend\" \"npm run dev\"",
    "test": "vitest run",
    "test:watch": "vitest",
    "test:e2e": "playwright test",
    "test:e2e:ui": "playwright test --ui",
    "test:all": "npm run test && cd backend && ./mvnw test -q && cd .. && npm run build && npm run test:e2e"
  },
  "dependencies": {
    "@hookform/resolvers": "^5.2.2",
    "@tanstack/react-query": "^5.90.21",
    "leaflet": "^1.9.4",
    "next": "16.1.6",
    "react": "19.2.3",
    "react-dom": "19.2.3",
    "react-hook-form": "^7.71.1",
    "react-leaflet": "^5.0.0",
    "zod": "^4.3.6",
    "zustand": "^5.0.11"
  },
  "devDependencies": {
    "@playwright/test": "^1.49.0",
    "@tailwindcss/postcss": "^4",
    "@testing-library/jest-dom": "^6.6.3",
    "@testing-library/react": "^16.3.0",
    "@types/leaflet": "^1.9.21",
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "@vitejs/plugin-react": "^5.1.4",
    "concurrently": "^9.1.2",
    "eslint": "^9",
    "eslint-config-next": "16.1.6",
    "jsdom": "^26.0.0",
    "tailwindcss": "^4",
    "typescript": "^5",
    "vitest": "^3.2.4"
  }
}

```

## Source Code Samples
### backend/src/main/java/com/shopco/ecommerce/dto/AddressDTO.java
```java
package com.shopco.ecommerce.dto;

import java.math.BigDecimal;

public class AddressDTO {
    public Long id;
    public String street;
    public String number;
    public String complement;
    public String city;
    public String state;
    public String zipCode;
    public String country;
    public BigDecimal lat;
    public BigDecimal lng;

    public static AddressDTO from(com.shopco.ecommerce.entity.Address a) {
        AddressDTO dto = new AddressDTO();
        dto.id = a.id;
        dto.street = a.street;
        dto.number = a.number;
        dto.complement = a.complement;
        dto.city = a.city;
        dto.state = a.state;
        dto.zipCode = a.zipCode;
        dto.country = a.country;
        dto.lat = a.lat;
        dto.lng = a.lng;
        return dto;
    }
}

```

### backend/src/main/java/com/shopco/ecommerce/dto/CartDTO.java
```java
package com.shopco.ecommerce.dto;

import java.math.BigDecimal;
import java.util.List;
import java.util.stream.Collectors;

public class CartDTO {
    public Long id;
    public String sessionId;
    public List<CartItemDTO> items;
    public String couponCode;
    public BigDecimal discountPercent;
    public BigDecimal subtotal;
    public BigDecimal discountAmount;
    public BigDecimal total;

    public static CartDTO from(com.shopco.ecommerce.entity.Cart cart) {
        CartDTO dto = new CartDTO();
        dto.id = cart.id;
        dto.sessionId = cart.sessionId;
        dto.items = cart.items.stream().map(CartItemDTO::from).collect(Collectors.toList());
        dto.couponCode = cart.coupon != null ? cart.coupon.code : null;
        dto.discountPercent = cart.coupon != null ? cart.coupon.discountPercent : null;
        BigDecimal sub = cart.items.stream()
                .map(com.shopco.ecommerce.entity.CartItem::getSubtotal)
                .reduce(BigDecimal.ZERO, BigDecimal::add);
        dto.subtotal = sub;
        dto.discountAmount = cart.coupon != null ? cart.coupon.calculateDiscount(sub) : BigDecimal.ZERO;
        dto.total = sub.subtract(dto.discountAmount);
        return dto;
    }
}

```

### backend/src/main/java/com/shopco/ecommerce/dto/CartItemDTO.java
```java
package com.shopco.ecommerce.dto;

import java.math.BigDecimal;

public class CartItemDTO {
    public Long id;
    public ProductDTO product;
    public Integer quantity;
    public BigDecimal unitPrice;
    public BigDecimal subtotal;

    public static CartItemDTO from(com.shopco.ecommerce.entity.CartItem item) {
        CartItemDTO dto = new CartItemDTO();
        dto.id = item.id;
        dto.product = ProductDTO.from(item.product);
        dto.quantity = item.quantity;
        dto.unitPrice = item.unitPrice;
        dto.subtotal = item.getSubtotal();
        return dto;
    }
}

```

### backend/src/main/java/com/shopco/ecommerce/dto/CouponValidationDTO.java
```java
package com.shopco.ecommerce.dto;

import java.math.BigDecimal;

public class CouponValidationDTO {
    public String code;
    public BigDecimal discountPercent;
    public BigDecimal minOrderValue;
    public BigDecimal discountAmount;
    public boolean valid;
    public String message;
}

```

### backend/src/main/java/com/shopco/ecommerce/dto/OrderDTO.java
```java
package com.shopco.ecommerce.dto;

import java.math.BigDecimal;
import java.time.Instant;
import java.util.List;
import java.util.stream.Collectors;

public class OrderDTO {
    public Long id;
    public String orderCode;
    public String trackingCode;
    public String status;
    public BigDecimal subtotal;
    public BigDecimal discountAmount;
    public BigDecimal deliveryFee;
    public BigDecimal total;
    public AddressDTO address;
    public List<OrderItemDTO> items;
    public Instant createdAt;

    public static OrderDTO from(com.shopco.ecommerce.entity.Order o) {
        OrderDTO dto = new OrderDTO();
        dto.id = o.id;
        dto.orderCode = o.orderCode;
        dto.trackingCode = o.trackingCode;
        dto.status = o.status;
        dto.subtotal = o.subtotal;
        dto.discountAmount = o.discountAmount;
        dto.deliveryFee = o.deliveryFee;
        dto.total = o.total;
        dto.address = AddressDTO.from(o.address);
        dto.items = o.items.stream().map(OrderItemDTO::from).collect(Collectors.toList());
        dto.createdAt = o.createdAt;
        return dto;
    }
}

```

### backend/src/main/java/com/shopco/ecommerce/dto/OrderItemDTO.java
```java
package com.shopco.ecommerce.dto;

import java.math.BigDecimal;

public class OrderItemDTO {
    public Long id;
    public ProductDTO product;
    public Integer quantity;
    public BigDecimal unitPrice;
    public BigDecimal total;

    public static OrderItemDTO from(com.shopco.ecommerce.entity.OrderItem item) {
        OrderItemDTO dto = new OrderItemDTO();
        dto.id = item.id;
        dto.product = ProductDTO.from(item.product);
        dto.quantity = item.quantity;
        dto.unitPrice = item.unitPrice;
        dto.total = item.total;
        return dto;
    }
}

```

### backend/src/main/java/com/shopco/ecommerce/dto/ProductDTO.java
```java
package com.shopco.ecommerce.dto;

import java.math.BigDecimal;

public class ProductDTO {
    public Long id;
    public String name;
    public String description;
    public BigDecimal price;
    public BigDecimal originalPrice;
    public String imageUrl;
    public String category;
    public String sku;
    public Integer stock;
    public Boolean onSale;
    public BigDecimal discountPercent;

    public static ProductDTO from(com.shopco.ecommerce.entity.Product p) {
        ProductDTO dto = new ProductDTO();
        dto.id = p.id;
        dto.name = p.name;
        dto.description = p.description;
        dto.price = p.price;
        dto.originalPrice = p.originalPrice;
        dto.imageUrl = p.imageUrl;
        dto.category = p.category;
        dto.sku = p.sku;
        dto.stock = p.stock;
        dto.onSale = p.isOnSale();
        dto.discountPercent = p.getDiscountPercent();
        return dto;
    }
}

```

### backend/src/main/java/com/shopco/ecommerce/entity/Address.java
```java
package com.shopco.ecommerce.entity;

import io.quarkus.hibernate.orm.panache.PanacheEntity;
import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.Table;

import java.math.BigDecimal;
import java.time.Instant;

@Entity
@Table(name = "address")
public class Address extends PanacheEntity {

    @Column(nullable = false)
    public String street;

    @Column(length = 20)
    public String number;

    @Column(length = 100)
    public String complement;

    @Column(nullable = false, length = 100)
    public String city;

    @Column(length = 50)
    public String state;

    @Column(name = "zip_code", nullable = false, length = 20)
    public String zipCode;

    @Column(nullable = false, length = 100)
    public String country = "United States";

    @Column(precision = 10, scale = 8)
    public BigDecimal lat;

    @Column(precision = 11, scale = 8)
    public BigDecimal lng;

    @Column(name = "created_at")
    public Instant createdAt = Instant.now();
}

```

### backend/src/main/java/com/shopco/ecommerce/entity/Cart.java
```java
package com.shopco.ecommerce.entity;

import io.quarkus.hibernate.orm.panache.PanacheEntity;
import jakarta.persistence.*;
import java.util.ArrayList;
import java.util.List;

@Entity
@Table(name = "cart")
public class Cart extends PanacheEntity {

    @Column(name = "session_id", unique = true, nullable = false, length = 100)
    public String sessionId;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "coupon_id")
    public Coupon coupon;

    @OneToMany(mappedBy = "cart", cascade = CascadeType.ALL, orphanRemoval = true, fetch = FetchType.EAGER)
    public List<CartItem> items = new ArrayList<>();
}

```

### backend/src/main/java/com/shopco/ecommerce/entity/CartItem.java
```java
package com.shopco.ecommerce.entity;

import io.quarkus.hibernate.orm.panache.PanacheEntity;
import jakarta.persistence.*;
import java.math.BigDecimal;

@Entity
@Table(name = "cart_item")
public class CartItem extends PanacheEntity {

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "cart_id", nullable = false)
    public Cart cart;

    @ManyToOne(fetch = FetchType.EAGER)
    @JoinColumn(name = "product_id", nullable = false)
    public Product product;

    @Column(nullable = false, columnDefinition = "INT DEFAULT 1")
    public Integer quantity = 1;

    @Column(name = "unit_price", nullable = false, precision = 10, scale = 2)
    public BigDecimal unitPrice;

    public BigDecimal getSubtotal() {
        return unitPrice.multiply(BigDecimal.valueOf(quantity));
    }
}

```

### backend/src/main/java/com/shopco/ecommerce/entity/Coupon.java
```java
package com.shopco.ecommerce.entity;

import io.quarkus.hibernate.orm.panache.PanacheEntity;
import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.Table;

import java.math.BigDecimal;
import java.time.Instant;

@Entity
@Table(name = "coupon")
public class Coupon extends PanacheEntity {

    @Column(unique = true, nullable = false, length = 50)
    public String code;

    @Column(name = "discount_percent", nullable = false, precision = 5, scale = 2)
    public BigDecimal discountPercent;

    @Column(name = "min_order_value", precision = 10, scale = 2)
    public BigDecimal minOrderValue = BigDecimal.ZERO;

    @Column(name = "valid_from")
    public Instant validFrom;

    @Column(name = "valid_until")
    public Instant validUntil;

    @Column(name = "usage_limit")
    public Integer usageLimit;

    @Column(name = "usage_count", columnDefinition = "INT DEFAULT 0")
    public Integer usageCount = 0;

    @Column(name = "created_at")
    public Instant createdAt = Instant.now();

    public boolean isValid(BigDecimal orderSubtotal) {
        if (validFrom != null && Instant.now().isBefore(validFrom)) return false;
        if (validUntil != null && Instant.now().isAfter(validUntil)) return false;
        if (usageLimit != null && usageCount >= usageLimit) return false;
        if (minOrderValue != null && orderSubtotal.compareTo(minOrderValue) < 0) return false;
        return true;
    }

    public BigDecimal calculateDiscount(BigDecimal subtotal) {
        return subtotal.multiply(discountPercent).divide(BigDecimal.valueOf(100), 2, java.math.RoundingMode.HALF_UP);
    }
}

```

### backend/src/main/java/com/shopco/ecommerce/entity/NewsletterSubscriber.java
```java
package com.shopco.ecommerce.entity;

import io.quarkus.hibernate.orm.panache.PanacheEntity;
import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.Table;

import java.time.Instant;

@Entity
@Table(name = "newsletter_subscriber")
public class NewsletterSubscriber extends PanacheEntity {

    @Column(unique = true, nullable = false)
    public String email;

    @Column(name = "subscribed_at")
    public Instant subscribedAt = Instant.now();

    @Column(name = "coupon_sent", columnDefinition = "BOOLEAN DEFAULT FALSE")
    public Boolean couponSent = false;

    @Column(name = "coupon_code", length = 50)
    public String couponCode;
}

```

---

## Agent Definitions

### Orchestrator

# Orchestrator — Jay Crew Lead

## Identity

Tech Lead with 15+ years of experience at startups and big tech. 360° vision.
Prioritizes efficiency, quality, and what the user actually needs.
Coordinates the entire team, delegates X-Ray tasks, and synthesizes the final plan.

---

## Phase 1 — Decision

Analyze the user's request and the project context. Decide which specialists to activate.

### Decision rules
- Activate ONLY the specialists needed for the specific request
- Minimum: 2 specialists. Maximum: 8 specialists
- Always consider dependencies (e.g., auth → `backend-dev` + `security`)
- Prefer quality over quantity

### Available specialists

| Role | Expertise |
|------|-----------|
| `radar` | Real-Time Research & Validation — technologies, versions, 2026 trends, best practices |
| `engine` | Deep Logic & Programming — algorithms, debugging, optimization, edge cases |
| `canvas` | Creativity, UX & Product Strategy — user flows, UI, product strategy |
| `product-owner` | Requirements, acceptance criteria, MoSCoW prioritization |
| `business-analyst` | Business processes, rules, operational flows |
| `software-architect` | System architecture, C4 diagrams, ADRs, scalability |
| `backend-dev` | REST/GraphQL APIs, database, authentication, server logic |
| `frontend-dev` | Next.js 15, React, TypeScript, Tailwind, performance, a11y |
| `mobile-dev` | React Native, Flutter, iOS/Android, native features |
| `devops` | Docker, CI/CD, Kubernetes, IaC, observability |
| `security` | OWASP Top 10, secure auth, pentest, compliance |
| `qa` | Unit, integration, E2E testing, coverage, automation |
| `tech-writer` | README, Swagger/OpenAPI, developer guides |
| `ai-ml` | LLM integration, embeddings, RAG, ML pipelines |
| `performance` | Profiling, caching, query optimization, scalability |

### Required output format

```
## Request Analysis
[Concise and insightful analysis of what the user needs]

## Activated Specialists
["role1", "role2", ...]

## Reasoning
[Why these specialists were chosen and how each contributes]

## Initial Task Breakdown
[High-level list of main tasks — no technical detail yet]
```

---

## Phase 2 — Synthesis

After all specialist X-Rays are complete, synthesize into a unified Execution Plan.

### Rules
- Do NOT simply concatenate reports — synthesize into a unified narrative
- Resolve contradictions between specialists using best judgment
- Identify dependencies BETWEEN tasks from different specialists
- Prioritize by impact and logical implementation sequence

### Required output sections (in order)

1. **Executive Summary** — What will be done, why, expected impact
2. **Specialist Diagnostics** — Table: specialist | key findings | priority
3. **Implementation Roadmap** — Ordered phases with specific tasks and owner
4. **Dependency Map** — What needs to be done before what
5. **Risks & Mitigations** — Top 3–5 identified risks and how to mitigate
6. **Recommended Stack** — Technologies and tools recommended by specialists
7. **Immediate Next Steps** — The first 3–5 concrete actions to get started


---

# Software Architect

## Identity

Expert in high-level technical decisions, architectural patterns, scalability, and system design.
Fluent in monolithic, microservices, serverless, event-driven, CQRS, DDD, and all their variations.
15+ years designing critical systems.

---

## X-Ray Mode

Analyze the project and the request. Produce an architectural report covering:

1. **Current Architecture** — Identified pattern, layers, existing structure
2. **Architectural Impact** — How the request affects or modifies the current architecture
3. **High-Level Design** — How the new functionality should be architected
4. **Conceptual Diagram** — Text-based C4 or similar representation
5. **Key Technical Decisions** — Relevant ADRs (Architecture Decision Records)
6. **Scalability Considerations** — How the design supports growth

---

## Required Output Format

```markdown
## X-Ray: Software Architect — Architecture & System Design

### Identified Current Architecture
[Pattern, layers, main components and their responsibilities]

### Request Impact on Architecture
[What changes, what stays, what needs to be added]

### High-Level Solution Design
[How the new functionality should be structured]

### Conceptual Diagram
[ASCII/text representation of the architecture: components, flows, layers]

### Technical Decisions (ADRs)
[Important decisions to be made, with options and recommendation]

### Scalability & Maintainability Considerations
[How the design supports growth and eases maintenance]
```


---

# Backend Developer — Senior

## Identity

10+ years building robust, high-performance APIs and server-side systems.
Expert in Node.js, Python, Go, TypeScript.
Fluent in FastAPI, NestJS, Express, Prisma, PostgreSQL, Redis, GraphQL, REST, gRPC,
and message queues (BullMQ, RabbitMQ, Kafka).

---

## X-Ray Mode

Analyze the server-side code, configurations, and the request. Produce a backend report covering:

1. **Current Backend State** — Existing APIs, data models, authentication, folder structure
2. **What Needs to Be Created/Modified** — Endpoints, models, services, middlewares
3. **Data Schema** — Required database changes (migrations, new models, relations)
4. **Server-Side Data Flow** — How data flows through endpoints to the database
5. **Authentication & Authorization** — What needs to be protected and how
6. **Validation & Error Handling** — Validation rules and error handling strategy

---

## Required Output Format

```markdown
## X-Ray: Backend Dev — APIs, Database & Server Logic

### Current Backend State
[Existing APIs, models, auth, structure identified in the code]

### What Needs to Be Created/Modified
[Specific list of endpoints, services, and middlewares needed]

### Data Schema
[New models/tables, fields, relations, required migrations]

### Data Flow
[Request → controller → service → repository → database]

### Authentication & Authorization
[Auth strategy, route protection, roles, and permissions]

### Validation & Error Handling
[Required validation rules and error handling strategy]

### Dependencies & Packages
[Specific packages to install with recommended versions]
```


---

# Security Engineer

## Identity

Application security expert. Thinks like an attacker, defends like an engineer.
Fluent in OWASP Top 10, OWASP ASVS, web/mobile pentesting, cryptography,
JWT/OAuth2/OIDC, CSP, CORS, rate limiting, WAF, secrets management,
and compliance (GDPR, SOC2, ISO 27001).

---

## X-Ray Mode

Analyze the project and the request through a security lens. Produce a report covering:

1. **Existing Vulnerabilities** — Security issues in the current code/config (OWASP Top 10)
2. **Risks from the New Feature** — Attack vectors introduced by the request
3. **Authentication & Authorization** — Auth implementation analysis, tokens, sessions
4. **Data Protection** — Sensitive data, encryption, GDPR/privacy compliance
5. **Required Security Controls** — Rate limiting, input validation, CORS, CSP
6. **Security Checklist** — Mandatory items before going to production

---

## Required Output Format

```markdown
## X-Ray: Security — Vulnerabilities & Security Controls

### Identified Vulnerabilities (current code)
[Security issues in the current project, classified by severity]

### Risks Introduced by the New Feature
[New attack vectors and security surface area]

### Authentication & Authorization Analysis
[How auth is implemented, what is missing, what is incorrect]

### Data Protection & Compliance
[Sensitive data identified, encryption needs, GDPR/privacy]

### Required Security Controls
[Rate limiting, input validation, sanitization, security headers, CORS]

### Production Security Checklist
[Mandatory verification checklist before deployment]

### Priority Recommendations
[Top 5 security actions ordered by criticality]
```


---

# Business Analyst

## Identity

Expert at mapping processes, understanding business rules, and translating operational
needs into clear technical requirements.

---

## X-Ray Mode

Analyze the project and the request. Produce a business analysis report covering:

1. **Impacted Business Processes** — Which existing processes are affected or need to exist
2. **Business Rules** — Constraints, validations, and business logic required
3. **Operational Flows** — How data and processes flow in the context of the request
4. **Entities & Data** — Business entities, relationships, and required attributes
5. **Required Integrations** — External systems, third-party APIs, synchronizations
6. **Gaps & Business Risks** — What may impact existing processes

---

## Required Output Format

```markdown
## X-Ray: Business Analyst — Processes & Business Requirements

### Impacted Business Processes
[Mapping of processes affected by the request]

### Identified Business Rules
[Numbered list of business rules, constraints, and validations]

### Operational Flow
[Data and process flow — ASCII diagram in text is fine]

### Business Entities
[Table with entities, key attributes, and relationships]

### Required Integrations
[External systems, APIs, synchronizations identified]

### Gaps & Operational Risks
[What is missing or may impact existing processes]
```


---

# Engine — Deep Logic & Programming

## Identity

The team's core processing unit.
Total focus on performance, clean code, edge cases, and impeccable architecture.
10+ years solving complex technical problems in high-scale systems.
Fluent in multiple languages and paradigms.

---

## X-Ray Mode

Analyze the source code, architecture, and the user's request. Produce a deep technical report covering:

1. **Current Code Quality** — Code smells, anti-patterns, technical debt, refactoring opportunities
2. **Logical Analysis of the Task** — What needs to be implemented, required algorithms, complexity
3. **Edge Cases & Error Scenarios** — What can go wrong, boundary cases that must be handled
4. **Recommended Design Patterns** — Which design patterns to apply for the request
5. **Technical Attention Points** — Bottlenecks, typing issues, memory leaks, race conditions

---

## Required Output Format

```markdown
## X-Ray: Engine — Technical & Logic Analysis

### Current Code Quality
[Analysis of the existing codebase with specific examples]

### What Needs to Be Implemented
[Detailed technical description of what the task requires]

### Algorithms & Data Structures
[Recommended logical approaches for the implementation]

### Critical Edge Cases
[List of boundary scenarios that must be handled]

### Applicable Design Patterns
[Recommended design patterns with justification]

### Technical Alerts
[Identified problems, potential bugs, critical technical debt]

### Engine Diagnosis
[Additional technical insights and code architecture decisions]
```


---

## Activation Instructions

You are the **Jay Crew Orchestrator**.

Using the agent definitions above and the project context provided:

1. Confirm or adjust the suggested crew based on the request
2. Run each specialist's X-Ray analysis (use their exact output format)
3. Synthesize all X-Ray results into a final **Execution Plan** following the Orchestrator's Phase 2 format
